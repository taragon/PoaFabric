{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Upcycler Dashboard | Poafabric</title>
    <link rel="stylesheet" href="{% static 'user/styles.css' %}">
</head>
<body>
    <div class="dashboard-container">

        <!-- HEADER -->
        <header class="dashboard-header blue-bar">
            <h1>REUSE UPCYLE!</h1>
            <p>Here are items you can upcycle and nearby recycling centers.</p>
        </header>
        
        <!-- ITEMS SECTION -->
        <section class="items-section">
            <h2>UPCYCLING ITEMS</h2>
            <div class="items-grid">

                <div class="item-card" onclick="toggleDetails(this)">
                    <h3>👕 Clothing</h3>
                    <div class="item-details">
                        <ul>
                            <li>👚 Old Shirts - Tote Bags</li>
                            <li>👖 Jeans - Pouches</li>
                            <li>🧥 Jackets - Aprons</li>
                            <li>👗 Dresses - Skirts</li>
                        </ul>
                    </div>
                </div>

                <div class="item-card" onclick="toggleDetails(this)">
                    <h3>🛏️ Home Textiles</h3>
                    <div class="item-details">
                        <ul>
                            <li>🛌 Bedsheets - Curtains</li>
                            <li>🛋️ Blankets - Pet Beds</li>
                            <li>🪟 Curtains - Cushion Covers</li>
                        </ul>
                    </div>
                </div>

                <div class="item-card" onclick="toggleDetails(this)">
                    <h3>👜 Fashion Accessories</h3>
                    <div class="item-details">
                        <ul>
                            <li>🧢 Caps - Coin Pouches</li>
                            <li>🧤 Gloves - Stuffed Toys</li>
                            <li>🧣 Scarves - Headbands</li>
                        </ul>
                    </div>
                </div>

                <div class="item-card" onclick="toggleDetails(this)">
                    <h3>🎨 Decorative Textiles</h3>
                    <div class="item-details">
                        <ul>
                            <li>🖼️ Wall Hangings - Fabric Art</li>
                            <li>🪑 Table Runners - Quilts</li>
                            <li>🪟 Curtains - Fabric Storage Bins</li>
                        </ul>
                    </div>
                </div>

                <div class="item-card" onclick="toggleDetails(this)">
                    <h3>👟 Footwear</h3>
                    <div class="item-details">
                        <ul>
                            <li>👞 Old Shoes - Planters</li>
                            <li>🩴 Flip Flops - Key Holders</li>
                        </ul>
                    </div>
                </div>

                <div class="item-card" onclick="toggleDetails(this)">
                    <h3>🏭 Industrial Textiles</h3>
                    <div class="item-details">
                        <ul>
                            <li>🧤 Work Gloves - Pot Holders</li>
                            <li>🦺 Reflective Vests - Bike Accessories</li>
                        </ul>
                    </div>
                </div>

            </div>
        </section>

        <!-- RECYCLING CENTERS -->
        <section class="centers-section">
            <h2>RECYCLING CENTERS</h2>
            <ul class="recycling-centers">
                <li onclick="toggleContact('center1')">
                    <strong>♻️ Strathmore University Upcycling Center</strong>
                    <div id="center1" class="contact-info" style="display: none;">
                        📍 Madaraka, Nairobi<br>
                        📞 +254 700 123 456<br>
                        📧 recycle@strathmore.edu
                    </div>
                </li>
                <li onclick="toggleContact('center2')">
                    <strong>♻️ Riara University Upcycling Drop-Off</strong>
                    <div id="center2" class="contact-info" style="display: none;">
                        📍 Mbagathi Way, Nairobi<br>
                        📞 +254 711 654 321<br>
                        📧 green@riara.ac.ke
                    </div>
                </li>
                <li onclick="toggleContact('center3')">
                    <strong>♻️ Kenyatta University Green Hub</strong>
                    <div id="center3" class="contact-info" style="display: none;">
                        📍 Thika Road, Nairobi<br>
                        📞 +254 722 222 222<br>
                        📧 ku-green@ku.ac.ke
                    </div>
                </li>
                <li onclick="toggleContact('center4')">
                    <strong>♻️ City Market Textile Drop-Off Point</strong>
                    <div id="center4" class="contact-info" style="display: none;">
                        📍 City Market, Nairobi CBD<br>
                        📞 +254 733 444 555<br>
                        📧 marketdrop@nairobicity.go.ke
                    </div>
                </li>
            </ul>
        </section>

        <!-- WHY UPCYCLING MATTERS -->
        <section class="importance-section">
            <h2>Why Upcycling Matters</h2>
            <ul>
                <li>✅ Reduces textile waste and environmental pollution</li>
                <li>✅ Gives old materials a second life as valuable items</li>
                <li>✅ Saves money and promotes creativity</li>
                <li>✅ Cuts down on production energy and raw material use</li>
                <li>✅ Creates job opportunities and supports local artisans</li>
            </ul>
        </section>

        <section class="marketplace-section">
            <h2>🌟 Upcycling Marketplace</h2>
            <p>Find creative items made from recycled materials!</p>
        
            <div class="marketplace-grid">
                <div class="marketplace-item">
                    <img src="/static/user/images/ecobag.avif" alt="Upcycled Bag">
                    <h3>Eco-friendly Bag @1000/-</h3>
                    <p>Made from old jeans! Stylish and durable.</p>
                    <button class="buy-btn">Buy Now</button>
                </div>
        
                <div class="marketplace-item">
                    <img src="/static/user/images/vintagelamp.avif" alt="Upcycled Lamp">
                    <h3>Vintage Lamp @5000/-</h3>
                    <p>Transformed from scrap metal and wood.</p>
                    <button class="buy-btn">Buy Now</button>
                </div>
        
                <div class="marketplace-item">
                    <img src="/static/user/images/wallet.avif" alt="Upcycled Wallet">
                    <h3>Wallet @2000/-</h3>
                    <p>Upcycled leather into a sleek wallet.</p>
                    <button class="buy-btn">Buy Now</button>
                </div>
            </div>
        </section>
<!-- My purchases -->
<section class="purchases-section">
    <h2>🛒 My Purchases</h2>
    <div id="purchaseList" class="purchase-list">
        <p>No purchases yet.</p>
    </div>
    <button id="clearPurchasesBtn" class="clear-btn">Clear Purchases</button>
    <button id="downloadReceiptBtn" class="download-btn">Download Receipt</button>
</section>

        

        <!-- TEXTILE IMPACT SECTION -->
        <section class="impact-section">
            <h2 onclick="toggleSection('impactContent')">Our Upcycling Impact</h2>
            <div id="impactContent" class="hidden-content">
                <p>Textiles Recycled This Month:</p>
                <div class="progress-bar">
                    <div class="progress" style="width: 60%;">60%</div>
                </div>
            </div>
        </section>

        <div id="testimonialsContent" class="hidden-content">
            <div class="testimonial-card active">
                <p>"Upcycling helped me create art from rags. Thanks PoaFabric!"</p>
                <strong>– Ryan, Artist</strong>
            </div>
            <div class="testimonial-card">
                <p>"Old curtains turned into tote bags! A big win for the planet."</p>
                <strong>– NJANJA, Student</strong>
            </div>
            <div class="testimonial-card">
                <p>"My denim jeans are now beautiful cushion covers! Amazing idea!"</p>
                <strong>– Sarah, Designer</strong>
            </div>
        
            <!-- Add your Next button here inside testimonialsContent -->
            <button id="nextTestimonialBtn">Next</button>
        </div>
        
        
        

        <!-- BADGE SECTION -->
        <section class="badge-section">
            <h2>Your Upcycle Badge</h2>
            <div class="user-badge" id="upcycleBadge" title="Top Upcycler Award">
                🥇<p>Gold Upcycler</p>
            </div>
        </section>

        <!-- BUTTONS -->
        <div class="button-container">
            <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
            <a href="https://docs.google.com/forms/d/e/1FAIpQLSdDTQ47o4Ewt_Tm1JG2V-cwYWWn7Ndw1_dFzTylBZAlIJmOvQ/viewform" target="_blank" class="donate-btn">Donate</a>
        </div>

    </div>

    <!-- SCRIPTS -->
    <script>
        function toggleDetails(card) {
            const details = card.querySelector(".item-details");
            const isVisible = details.style.display === "block";
            details.style.display = isVisible ? "none" : "block";
        }

        function toggleContact(id) {
            const element = document.getElementById(id);
            const isVisible = element.style.display === 'block';
            document.querySelectorAll('.contact-info').forEach(el => el.style.display = 'none');
            if (!isVisible) {
                element.style.display = 'block';
            }
        }

        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                const isVisible = section.style.display === 'block';
                section.style.display = isVisible ? 'none' : 'block';
            }
        }

        const upcycleBadge = document.getElementById("upcycleBadge");
        function showGoldBadge() {
            upcycleBadge.classList.add("gold");
            upcycleBadge.innerHTML = "🥇<p>Gold Upcycler</p>";
        }
        showGoldBadge();
    </script>
    <script>
    function toggleDetails(card) {
        const details = card.querySelector(".item-details");
        const isVisible = details.style.display === "block";
        details.style.display = isVisible ? "none" : "block";
    }

    function toggleContact(id) {
        const element = document.getElementById(id);
        const isVisible = element.style.display === 'block';
        document.querySelectorAll('.contact-info').forEach(el => el.style.display = 'none');
        if (!isVisible) {
            element.style.display = 'block';
        }
    }

    function toggleSection(sectionId) {
        const section = document.getElementById(sectionId);
        if (section) {
            const isVisible = section.style.display === 'block';
            section.style.display = isVisible ? 'none' : 'block';
        }
    }

    const upcycleBadge = document.getElementById("upcycleBadge");
    function showGoldBadge() {
        upcycleBadge.classList.add("gold");
        upcycleBadge.innerHTML = "🥇<p>Gold Upcycler</p>";
    }
    showGoldBadge();

    // --- New Marketplace Logic ---

    // Handle buy buttons
    const buyButtons = document.querySelectorAll('.buy-btn');
    buyButtons.forEach(button => {
        button.addEventListener('click', function() {
            const itemName = this.previousElementSibling.previousElementSibling.textContent;
            showPurchasePopup(itemName);
        });
    });

    function showPurchasePopup(itemName) {
        const confirmed = confirm(`Do you want to purchase "${itemName}"?`);
        if (confirmed) {
            alert(`🎉 Thank you for purchasing the ${itemName}! We will contact you soon.`);
        } else {
            alert(`❌ Purchase canceled.`);
        }
    }
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const buyButtons = document.querySelectorAll('.buy-btn');
    
        buyButtons.forEach(button => {
            button.addEventListener('click', function () {
                const itemCard = this.closest(".marketplace-item");
                const itemName = itemCard.querySelector("h3").textContent;
                const itemDesc = itemCard.querySelector("p").textContent;
    
                const confirmed = confirm(`🛍️ Do you want to purchase "${itemName}"?\n\n${itemDesc}`);
                if (confirmed) {
                    // Store purchase in localStorage
                    let purchases = JSON.parse(localStorage.getItem("purchases") || "[]");
                    purchases.push({ name: itemName, description: itemDesc });
                    localStorage.setItem("purchases", JSON.stringify(purchases));
    
                    alert(`🎉 Thank you for purchasing "${itemName}"! Your order has been received.`);
                } else {
                    alert(`❌ Purchase cancelled.`);
                }
            });
        });
    });

        // Load and display purchases
        const purchaseList = document.getElementById("purchaseList");
        const purchases = JSON.parse(localStorage.getItem("purchases") || "[]");
    
        if (purchases.length > 0) {
            purchaseList.innerHTML = "";
            purchases.forEach(item => {
                const itemDiv = document.createElement("div");
                itemDiv.className = "purchase-item";
                itemDiv.innerHTML = `<strong>${item.name}</strong><p>${item.description}</p>`;
                purchaseList.appendChild(itemDiv);
            });
        }
            // Load and display purchases
    function renderPurchases() {
        const purchaseList = document.getElementById("purchaseList");
        const purchases = JSON.parse(localStorage.getItem("purchases") || "[]");

        if (purchases.length === 0) {
            purchaseList.innerHTML = "<p>No purchases yet.</p>";
            return;
        }

        purchaseList.innerHTML = "";
        purchases.forEach(item => {
            const itemDiv = document.createElement("div");
            itemDiv.className = "purchase-item";
            itemDiv.innerHTML = `<strong>${item.name}</strong><p>${item.description}</p>`;
            purchaseList.appendChild(itemDiv);
        });
    }

    renderPurchases(); // call this after DOM loads

    // Clear purchases button logic
    const clearBtn = document.getElementById("clearPurchasesBtn");
    clearBtn.addEventListener("click", () => {
        const confirmed = confirm("⚠️ Are you sure you want to clear all your purchases?");
        if (confirmed) {
            localStorage.removeItem("purchases");
            renderPurchases();
            alert("🧹 Purchases cleared successfully.");
        }
    });

    // Download receipt logic
const downloadBtn = document.getElementById("downloadReceiptBtn");
downloadBtn.addEventListener("click", () => {
    const purchases = JSON.parse(localStorage.getItem("purchases") || "[]");

    if (purchases.length === 0) {
        alert("🛑 No purchases to download.");
        return;
    }

    let receipt = `🧾 PoaFabric Receipt\nDate: ${new Date().toLocaleString()}\n\n`;
    purchases.forEach((item, index) => {
        receipt += `${index + 1}. ${item.name} - ${item.description}\n`;
    });

    const blob = new Blob([receipt], { type: "text/plain" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "poafabric_receipt.txt";
    a.click();
    URL.revokeObjectURL(url);
});

        
    </script>
    <script>
        // Animate the progress bar when it appears
        document.addEventListener("DOMContentLoaded", function() {
            const progress = document.querySelector(".progress");
            let width = 0;
            const targetWidth = 60; // Your target progress in %
        
            function animateProgress() {
                if (width < targetWidth) {
                    width++;
                    progress.style.width = width + "%";
                    progress.textContent = width + "%";
                    setTimeout(animateProgress, 20); // Speed of animation
                }
            }
        
            // Start animation when the page loads
            animateProgress();
        });
        </script>

        <script>
            // Testimonials Carousel
            document.addEventListener("DOMContentLoaded", function () {
                const testimonials = document.querySelectorAll('.testimonial-card');
                let current = 0;
            
                function showTestimonial(index) {
                    testimonials.forEach((testimonial, idx) => {
                        testimonial.style.display = idx === index ? 'block' : 'none';
                    });
                }
            
                function nextTestimonial() {
                    current = (current + 1) % testimonials.length;
                    showTestimonial(current);
                }
            
                showTestimonial(current);
                setInterval(nextTestimonial, 4000); // Change testimonial every 4 seconds
            });

            const testimonialCards = document.querySelectorAll('#testimonialsContent .testimonial-card');
const nextBtn = document.getElementById('nextTestimonialBtn');

let currentTestimonial = 0;

nextBtn.addEventListener('click', function() {
    // Hide current
    testimonialCards[currentTestimonial].classList.remove('active');

    // Move to next (loop back if at the end)
    currentTestimonial = (currentTestimonial + 1) % testimonialCards.length;

    // Show next
    testimonialCards[currentTestimonial].classList.add('active');
});

            </script>
            

    
    


</body>
</html>
